<div class="form-control {{size ? 'form-control-' + size : ''}} typeahead-multiselect d-flex flex-row flex-wrap" (click)="focusInput()"
     placement="bottom" [ngbTooltip]="tooltipTemplate" triggers="manual"
     #t="ngbTooltip" (mouseenter)="openTooltip()" (mouseleave)="closeTooltip()">
    <span class="badge typeahead-multiselect__tag" *ngFor="let item of selectedItems" [ngClass]="getItemClass(item)">
        <span class="typeahead-multiselect__tag-title">{{item.label}}</span>
        <span class="fa fa-times remove-button" aria-hidden="true" (click)="removeItem(item)"></span>
    </span>

    <ng-template #template let-result="result" let-term="term" let-formatter="formatter">
        <div *ngIf="result.firstInGroup" class="typeahead-multiselect__type-label pull-right" [ngClass]="getTypeClass(result.model)">
            {{'typeahead-multiselect.type.' + result.model.type | translate}}
        </div>
        <div [ngClass]="{'fist-in-group-item': result.firstInGroup && !result.first}">
            <ngb-highlight [result]="formatter(result.model)" [term]="term"></ngb-highlight>
        </div>
    </ng-template>

    <input class="input typeahead-multiselect__input" name="inputValue"
           (keydown)="handleKeyDown($event); closeTooltip()"
           (focus)="openTooltip()"
           [placeholder]="showPlaceholder() ? placeholder : ''"
           [(ngModel)]="inputValue"
           [ngbTypeahead]="wrappedItemLoader"
           [resultFormatter]="formatResultItem"
           (selectItem)="selectItem($event)"
           [resultTemplate]="template"
           [focusFirst]="focusFirst"
           [style.width]="getInputWidth()"
           [size]="inputValue?.length+2"
           [editable]="editable"/>
</div>

<ng-template #tooltipTemplate>
    <p [innerHTML]="tooltip"></p>
</ng-template>
